I"™4<h4 id="1-lua-programming">1 LUA programming</h4>

<p>æœ€è¿‘éœ€è¦ç”¨Luaæ¥è§£å†³ä¸€äº›å®é™…é—®é¢˜, ç®€å•çš„å­¦ä¹ ä¸€ä¸‹.</p>

<p>luaä¸­çš„<strong>å…³é”®è¯</strong>:</p>

<table>
  <thead>
    <tr>
      <th><em>and</em></th>
      <th style="text-align: left"><em>break</em></th>
      <th><em>do</em></th>
      <th><em>else</em></th>
      <th><em>elseif</em></th>
      <th><em>end</em></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong><em>false</em></strong></td>
      <td style="text-align: left"><strong><em>for</em></strong></td>
      <td><strong><em>function</em></strong></td>
      <td><strong><em>if</em></strong></td>
      <td><strong><em>in local</em></strong></td>
      <td><strong><em>nil</em></strong></td>
    </tr>
    <tr>
      <td><strong><em>not</em></strong></td>
      <td style="text-align: left"><strong><em>or</em></strong></td>
      <td><strong><em>repeat</em></strong></td>
      <td><strong><em>return</em></strong></td>
      <td><strong><em>then true</em></strong></td>
      <td><strong><em>until</em></strong></td>
    </tr>
    <tr>
      <td><strong><em>while</em></strong></td>
      <td style="text-align: left">Â </td>
      <td>Â </td>
      <td>Â </td>
      <td>Â </td>
      <td>Â </td>
    </tr>
  </tbody>
</table>

<p>æ³¨é‡Š:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">--[[This is a lua comment--]]</span>
<span class="c1">--This is a lua comment.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Hello World!"</span><span class="p">)</span>
<span class="n">fruit</span> <span class="o">=</span> <span class="n">apple</span> <span class="o">+</span> <span class="n">oranges</span> <span class="c1">--get the total fruit </span>
</code></pre></div></div>

<h5 id="11-å˜é‡variables">1.1 å˜é‡(Variables)</h5>

<ul>
  <li>Global variables:</li>
  <li>Local variables:</li>
  <li>Table fields:</li>
</ul>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span>    <span class="c1">--declaration of d and f as local variables.</span>
<span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">;</span>		  <span class="c1">--declaration of d and f as global variables.</span>
<span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="mi">10</span>			  <span class="cm">--[[decalaration of d and f as global variables.
						  Here value of f is nil åˆå§‹åŒ–æ²¡ç»™å€¼å°±æ˜¯é»˜è®¤ä¸º"nil"--]]</span> 
</code></pre></div></div>

<p>å·¦å€¼å’Œå³å€¼</p>

<p>Lvalue: LæŒ‡çš„æ˜¯Location, è¡¨ç¤ºå¯å¯»å€.</p>

<p>Rvalue: RæŒ‡çš„æ˜¯Read, è¡¨ç¤ºå¯è¯».</p>

<p><strong>Luaæ˜¯ä¸€ç§åŠ¨æ€ç±»å‹è¯­è¨€, å˜é‡(variables)æ²¡æœ‰ç±»å‹, ä½†æ˜¯â€å€¼(value)â€æœ‰ç±»å‹, å€¼å­˜äºå˜é‡ä¸­.</strong></p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>nil</td>
      <td>Used to differentiate the value from having some data or no(nil) data.ç›¸å½“äºpythoné‡Œçš„None</td>
    </tr>
    <tr>
      <td>boolean</td>
      <td>Include true and false as values.</td>
    </tr>
    <tr>
      <td>number</td>
      <td>Represents real(double precision floating point) numbers.</td>
    </tr>
    <tr>
      <td>string</td>
      <td>Represents array of characters.</td>
    </tr>
    <tr>
      <td>function</td>
      <td>Represents a method that is written in C or Lua.</td>
    </tr>
    <tr>
      <td>userdata</td>
      <td>Represents arbitrary C data</td>
    </tr>
    <tr>
      <td>thread</td>
      <td>Represents independent threads of execution and it is used to implement coroutines.</td>
    </tr>
    <tr>
      <td>table</td>
      <td>Represent ordinary arrays, symbol tables, sets, records, graphs, trees, etc., and implements associative arrays. It can hold any value (except nil).</td>
    </tr>
  </tbody>
</table>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="s2">"What is my type"</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span>		<span class="c1">--&gt; number</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">print</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">true</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">nil</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="kc">nil</span><span class="p">)))</span>  <span class="c1">--&gt; string</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>å…³ç³»è¿ç®—ç¬¦</th>
      <th>==</th>
      <th>~=</th>
      <th>&gt;</th>
      <th>&lt;</th>
      <th>&gt;=</th>
      <th>&lt;=</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Â </td>
      <td>å«ä¹‰ç•¥</td>
      <td>ä¸ç­‰äº</td>
      <td>ç•¥</td>
      <td>ç•¥</td>
      <td>ç•¥</td>
      <td>ç•¥</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>é€»è¾‘è¿ç®—ç¬¦</th>
      <th>and</th>
      <th>or</th>
      <th>not</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Â </td>
      <td>ç•¥</td>
      <td>ç•¥</td>
      <td>ç•¥</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>å…¶ä»–æ“ä½œç¬¦</th>
      <th>..</th>
      <th>#</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Â </td>
      <td>concatenates two strings.</td>
      <td>An unary operator that return the length of the a string or a table. è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–tableçš„é•¿åº¦.</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>ç±»åˆ«</th>
      <th>æ“ä½œç¬¦</th>
      <th>å…³è”é¡ºåº</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ä¸€å…ƒ(Unary)</td>
      <td>not # -</td>
      <td>å³è‡³å·¦</td>
    </tr>
    <tr>
      <td>concatenation</td>
      <td>..</td>
      <td>å³è‡³å·¦</td>
    </tr>
    <tr>
      <td>ä¹˜é™¤(Multiplicative)</td>
      <td>* / %</td>
      <td>å·¦è‡³å³</td>
    </tr>
    <tr>
      <td>åŠ å‡(Additive)</td>
      <td>+-</td>
      <td>å·¦è‡³å³</td>
    </tr>
    <tr>
      <td>å…³ç³»(Relational)</td>
      <td>&lt; &gt; &lt;= &gt;= == ~=</td>
      <td>å·¦è‡³å³</td>
    </tr>
    <tr>
      <td>é€»è¾‘ä¸</td>
      <td>and</td>
      <td>å·¦è‡³å³</td>
    </tr>
    <tr>
      <td>é€»è¾‘æˆ–</td>
      <td>or</td>
      <td>å·¦è‡³å³</td>
    </tr>
  </tbody>
</table>

<h5 id="12-å¾ªç¯-å’Œ-æ¡ä»¶">1.2 å¾ªç¯ å’Œ æ¡ä»¶</h5>

<p>while, for, repeatâ€¦until.</p>

<p>break.</p>

<p>if else.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span><span class="p">(</span> <span class="kc">true</span> <span class="p">)</span>
<span class="k">do</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s2">"This loop will run forever."</span><span class="p">)</span>
<span class="k">end</span>
<span class="cm">--[[åªæœ‰false å’Œ nil ä¼šè¢«è®¤ä¸ºæ˜¯ä¸æ»¡è¶³æ¡ä»¶, å³ä¾¿æ˜¯0ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯æ»¡è¶³æ¡ä»¶çš„true--]]</span>
</code></pre></div></div>

<h5 id="13-å‡½æ•°">1.3 å‡½æ•°</h5>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">--[[Defining a Function--]]</span>
<span class="n">optinal_function_scope</span> <span class="n">funtion</span> <span class="n">function_name</span><span class="p">(</span><span class="n">argument1</span><span class="p">,</span> <span class="n">argument2</span><span class="p">,</span> <span class="o">...</span> <span class="n">argumentn</span><span class="p">)</span>
<span class="n">function_body</span>
<span class="k">return</span> <span class="n">result_params_comma_separated</span>
<span class="k">end</span>
</code></pre></div></div>

<p>ä¾‹å­:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">--[[ function returning the max between two numbers --]]</span>
<span class="k">function</span> <span class="nf">max</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">num1</span> <span class="o">&gt;</span> <span class="n">num2</span><span class="p">)</span> <span class="k">then</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">num2</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="k">end</span>
<span class="c1">-- calling a function</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The maximum of the two numbers is "</span><span class="p">,</span> <span class="n">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"The maximum of the two numbers is "</span><span class="p">,</span> <span class="n">max</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div></div>

<p>æŠŠå‡½æ•°å½“å˜é‡ä¼ é€’</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">myprint</span> <span class="o">=</span> <span class="k">function</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"This is my print function -  ##"</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="s2">"##"</span><span class="p">)</span>
<span class="k">end</span>

<span class="k">function</span> <span class="nf">add</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">,</span> <span class="n">functionPrint</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">+</span> <span class="n">num2</span>
    <span class="n">functionPrint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">myprint</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">myprint</span><span class="p">)</span>
</code></pre></div></div>

<p>æ¥å—å˜é•¿æ•°ç›®è¾“å…¥çš„å‡½æ•°</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="nf">average</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="kd">local</span> <span class="n">arg</span> <span class="o">=</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="k">in</span> <span class="nb">ipairs</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">do</span>  <span class="c1">-- ipairs ç›¸å½“ä¸ enumerate</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span> <span class="o">+</span> <span class="n">v</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">/#</span><span class="n">arg</span>
<span class="k">end</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"The average is"</span><span class="p">,</span> <span class="n">average</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div></div>

:ET